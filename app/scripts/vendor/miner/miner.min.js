var miner;!function(a){"use strict";a.isString=function(a){return"string"==typeof a||a instanceof String},a.isNumber=function(a){return"number"==typeof a},a.isBoolean=function(a){return"boolean"==typeof a},a.isFunction=function(a){return"function"==typeof a},a.isObject=function(a){return"object"==typeof a},a.isArray=function(a){return a.constructor===Array},a.isDate=function(a){return"[object Date]"===Object.prototype.toString.call(a)},a.isDefined=function(a){return void 0!==a},a.isUndefined=function(a){return void 0===a},a.isNull=function(a){return null===a},a.isModel=function(a){return"function"==typeof a.on},a.concat=function(){return Array.prototype.slice.call(arguments).join("")},a.template=function(b,c){return new a.Model(c).template(b)},a.version="$miner.version",a.request=function(b,c,d,e,f,g){var h=new XMLHttpRequest;if(h.open(b,c,!0),a.isDefined(e))for(var i in e)h.setRequestHeader(i,e[i]);h.onreadystatechange=function(){4==h.readyState&&(200==h.status?a.isFunction(f)&&f(h.responseText,h.statusText,h):a.isFunction(g)&&g(h.responseText,h.statusText,h))},h.send(d||null)},a.include=function(b,c,d,e){a.request("GET",b,null,{"content-type":"text/html"},function(b,e,f){c.innerHTML=b,a.isFunction(d)&&d(b,e,f)},function(b,c,d){a.isFunction(e)&&e(b,c,d)})};var b=function(){function b(a){this._fn=a}return b.prototype.isRendered=!1,b.prototype.render=function(a,b){this.el=a,this.data=b,this.el.innerHTML=this._fn(this.el,this.data),this.isRendered=!0},b.prototype.update=function(b){if(a.isDefined(b)){var c;if(!0===a.isModel(this.data))for(c in b)this.data.set(c,b[c]);else if(!0===a.isObject(this.data))for(c in b)this.data[c]=b[c]}this.render(this.el,this.data)},b}();a.View=b;var c=function(){function b(a,b){this._items=a||{},this._cbs=b||{}}return b.prototype.url="",b.prototype.get=function(a){return this._items[a]},b.prototype.set=function(a,b){this._items[a]=b,a in this._cbs&&this._cbs[a](b)},b.prototype.remove=function(a){delete this._items[a],a in this._cbs&&delete this._cbs[a]},b.prototype.clear=function(){this._items={},this._cbs={}},b.prototype.on=function(a,b){this._cbs[a]=b},b.prototype.un=function(a){delete this._cbs[a]},b.prototype.contains=function(a){return a in this._items},b.prototype.merge=function(a){for(var b in a)this.set(b,a[b])},b.prototype.each=function(a){for(var b in this._items)a(b,this.get(b))},b.prototype.count=function(){return Object.keys(this._items).length},b.prototype.clone=function(){return new b(this._items,this._cbs)},b.prototype.toJSON=function(){return JSON.stringify(this._items)},b.prototype.template=function(b){var c=this;return this.each(function(d,e){e=a.isFunction(e)?e(c):e,b=b.replace(new RegExp("{{"+d+"}}","g"),e||"")}),b},b.prototype.fetch=function(b,c,d){var e=this;a.request("get",this.url+"/"+b,this.toJSON(),{"content-type":"application/json"},function(b,d,f){a.isFunction(c)&&(e.clear(),e.merge(JSON.parse(data)[0]),c(b,d,f))},function(b,c,e){a.isFunction(d)&&d(b,c,e)})},b.prototype.save=function(b,c){a.request("post",this.url,this.toJSON(),{"content-type":"application/json"},function(c,d,e){a.isFunction(b)&&b(c,d,e)},function(b,d,e){a.isFunction(c)&&c(b,d,e)})},b.prototype.update=function(b,c,d){a.request("put",this.url+"/"+b,this.toJSON(),{"content-type":"application/json"},function(b,d,e){a.isFunction(c)&&c(b,d,e)},function(b,c,e){a.isFunction(d)&&d(b,c,e)})},b.prototype.destroy=function(b,c,d){a.request("delete",this.url+"/"+b,this.toJSON(),{"content-type":"application/json"},function(b,d,e){a.isFunction(c)&&c(b,d,e)},function(b,c,e){a.isFunction(d)&&d(b,c,e)})},b}();a.Model=c;var d=function(){function b(b,c,d){this._items=[],a.isUndefined(b)||(a.isArray(b)&&this.merge(b),a.isString(b)&&this.fetch(b,c,d))}return b.prototype.get=function(a){return this._items[a]},b.prototype.first=function(){return this._items[0]},b.prototype.last=function(){return this._items[this._items.length-1]},b.prototype.add=function(a){this._items.push(a)},b.prototype.remove=function(a){this._items.splice(a,1)},b.prototype.clear=function(){this._items=[]},b.prototype.merge=function(b){for(var c in b)this.add(new a.Model(b[c]))},b.prototype.each=function(a){for(var b in this._items)a(this.get(b),b)},b.prototype.count=function(a){return this._items.length},b.prototype.sort=function(a){this._items.sort(a)},b.prototype.filter=function(a){this._items=this._items.filter(a)},b.prototype.find=function(a){return this._items.find(a)},b.prototype.clone=function(){var b=new a.List;return this.each(function(a){b.add(a)}),b},b.prototype.slice=function(a,b){this.items=this.items.slice(a,b)},b.prototype.toJSON=function(){return this._items.map(function(a){return a.toJSON()})},b.prototype.template=function(a){var b="";return this.each(function(c){b+=c.template(a)}),b},b.prototype.fetch=function(b,c,d){var e=this;a.request("GET",b,null,{"content-type":"application/json"},function(b,d,f){e.clear(),e.merge(JSON.parse(b)),a.isFunction(c)&&c(e,d,f)},function(b,c,f){a.isFunction(d)&&d(e,c,f)})},b}();a.List=d;var e=function(){function b(a){this._routes=a||{}}return b.prototype.add=function(a,b){this._routes[a]=b},b.prototype.get=function(a){return this._routes[a]},b.prototype.remove=function(a){delete this._routes[a]},b.prototype.clear=function(){this._routes={}},b.prototype.contains=function(a){return a in this._routes},b.prototype.each=function(a){for(var b in this._routes)a(b,this.get(b))},b.prototype.count=function(){return Object.keys(this._routes).length},b.prototype.listen=function(b){var c=this;window.addEventListener("load",function(){c.call(window.location.hash)}),window.addEventListener("hashchange",function(){c.call(window.location.hash)}),a.isDefined(b)&&-1==location.href.indexOf("#")&&this.call(b)},b.prototype.ignore=function(){var a=this;window.removeEventListener("load",function(){a.call(window.location.hash)}),window.removeEventListener("hashchange",function(){a.call(window.location.hash)})},b.prototype.call=function(a){for(var b in this._routes){var c=a.match(new RegExp(b.replace(/:([^\/]+)/g,"([^/]*)"))),d={},e=b.match(/:([^\/]+)/g);if(c)return c.shift(),c.forEach(function(a,b){d[e[b].replace(":","")]=a}),void this.get(b)(d)}},b}();a.Router=e,a.JsonModelerControl=new a.View(function(b,c){var d=this,e=b.innerHTML,f=new a.Model;return f.url=this.data.url,f.fetch(this.data.id,function(c,f,g){a.isFunction(d.data.transform)&&d.data.transform(c),b.innerHTML=c.template(e),a.isFunction(d.data.success)&&d.data.success(c,f,g)},function(b,c,e){a.isFunction(d.data.failure)&&d.data.failure(b,c,e)}),this.data.text||""}),a.JsonRepeaterControl=new a.View(function(b,c){var d=this,e=b.innerHTML;new a.List(this.data.url,function(c,f,g){a.isFunction(d.data.transform)&&d.data.transform(c),b.innerHTML=c.template(e),a.isFunction(d.data.success)&&d.data.success(c,f,g)},function(b,c,e){a.isFunction(d.data.failure)&&d.data.failure(b,c,e)});return this.data.text||""}),a.ListRepeaterControl=new a.View(function(a,b){return b.src.template(a.innerHTML)})}(miner||(miner={}));